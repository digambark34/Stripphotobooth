{"ast":null,"code":"var _jsxFileName = \"D:\\\\Strip\\\\frontend\\\\src\\\\components\\\\CapturePage.js\",\n  _s = $RefreshSig$();\nimport { useRef, useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport '../styles/mobile.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function CapturePage() {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [steps, setSteps] = useState(0);\n  const [countdown, setCountdown] = useState(null);\n  const [settings, setSettings] = useState({\n    eventName: '',\n    background: {\n      type: 'color',\n      value: '#ff0000'\n    },\n    logo: null\n  });\n  const [notification, setNotification] = useState(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [capturedPhotos, setCapturedPhotos] = useState([]); // Store captured photo data\n\n  // Fallback API URL if environment variable is not set\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5000';\n\n  // Initialize canvas with background\n  const initializeCanvas = () => {\n    if (canvasRef.current) {\n      var _settings$background;\n      const ctx = canvasRef.current.getContext(\"2d\");\n      const width = 480;\n      const height = 720;\n      console.log('Initializing canvas...');\n\n      // Clear canvas\n      ctx.clearRect(0, 0, width, height);\n\n      // Apply background color\n      const bgColor = ((_settings$background = settings.background) === null || _settings$background === void 0 ? void 0 : _settings$background.value) || '#ff0000';\n      ctx.fillStyle = bgColor;\n      ctx.fillRect(0, 0, width, height);\n      console.log('Canvas initialized with background:', bgColor);\n    }\n  };\n\n  // Load settings from localStorage\n  useEffect(() => {\n    const savedSettings = localStorage.getItem('photoBoothSettings');\n    console.log('Loading settings from localStorage:', savedSettings);\n    if (savedSettings) {\n      const parsedSettings = JSON.parse(savedSettings);\n      console.log('Parsed settings:', parsedSettings);\n      setSettings(parsedSettings);\n    }\n  }, []);\n\n  // Initialize canvas when settings change\n  useEffect(() => {\n    if (canvasRef.current && settings.background.value) {\n      initializeCanvas();\n    }\n  }, [settings.background.value]);\n  useEffect(() => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(stream => {\n      if (videoRef.current) videoRef.current.srcObject = stream;\n    }).catch(error => {\n      console.warn(\"Camera access denied:\", error);\n      setNotification({\n        type: \"error\",\n        message: \"Camera access required. Please allow webcam access and refresh the page.\"\n      });\n    });\n  }, []);\n  const startCapture = () => {\n    if (steps >= 3) return;\n    setCountdown(3);\n    const countdownInterval = setInterval(() => {\n      setCountdown(prev => {\n        if (prev <= 1) {\n          clearInterval(countdownInterval);\n          takePhoto();\n          return null;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n  };\n  const takePhoto = () => {\n    var _settings$background2;\n    const ctx = canvasRef.current.getContext(\"2d\");\n    const width = 480;\n    const photoHeight = 240;\n    const fullHeight = 720;\n    console.log('Taking photo, step:', steps);\n\n    // First, ensure canvas has background\n    const bgColor = ((_settings$background2 = settings.background) === null || _settings$background2 === void 0 ? void 0 : _settings$background2.value) || '#ff0000';\n    console.log('Applying background color:', bgColor);\n\n    // Clear entire canvas and apply background\n    ctx.clearRect(0, 0, width, fullHeight);\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, width, fullHeight);\n\n    // Redraw all previously captured photos\n    capturedPhotos.forEach((photoData, index) => {\n      const img = new Image();\n      img.onload = () => {\n        ctx.drawImage(img, 0, index * photoHeight, width, photoHeight);\n      };\n      img.src = photoData;\n    });\n\n    // Capture current photo from video\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.width = width;\n    tempCanvas.height = photoHeight;\n    const tempCtx = tempCanvas.getContext('2d');\n    tempCtx.drawImage(videoRef.current, 0, 0, width, photoHeight);\n\n    // Store the captured photo data\n    const photoData = tempCanvas.toDataURL();\n    setCapturedPhotos(prev => [...prev, photoData]);\n\n    // Draw current photo on main canvas\n    console.log('Drawing current photo at position:', 0, steps * photoHeight, width, photoHeight);\n    ctx.drawImage(videoRef.current, 0, steps * photoHeight, width, photoHeight);\n\n    // Optional logo overlay\n    if (settings.logo) {\n      const img = new Image();\n      img.src = settings.logo; // settings.logo is already a base64 string\n      img.onload = () => {\n        ctx.drawImage(img, 10, 10, 100, 50);\n      };\n    }\n\n    // Optional event name text on last step\n    if (steps === 2 && settings.eventName) {\n      ctx.fillStyle = \"#ffffff\";\n      ctx.font = \"24px sans-serif\";\n      ctx.fillText(settings.eventName, 10, 710);\n    }\n    setSteps(steps + 1);\n  };\n  const submit = async () => {\n    if (isSubmitting) return;\n    try {\n      setIsSubmitting(true);\n      setNotification(null);\n      const dataUrl = canvasRef.current.toDataURL(\"image/jpeg\", 0.8);\n      await axios.post(`${API_BASE_URL}/api/strips`, {\n        image: dataUrl,\n        eventName: settings.eventName,\n        background: settings.background,\n        logo: settings.logo\n      });\n      setNotification({\n        type: \"success\",\n        message: \"✅ Thank you! Your photo strip has been sent for print.\"\n      });\n      setSteps(0);\n      setCapturedPhotos([]); // Clear captured photos\n      initializeCanvas(); // Clear and reinitialize with background\n    } catch (error) {\n      console.warn(\"Upload failed:\", error);\n      setNotification({\n        type: \"error\",\n        message: \"❌ Failed to upload. Please check your connection and try again.\"\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Auto-hide notification after 5 seconds\n  useEffect(() => {\n    if (notification) {\n      const timer = setTimeout(() => {\n        setNotification(null);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [notification]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 relative overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0 overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-pink-500/10 rounded-full blur-3xl animate-pulse delay-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), notification && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `fixed top-6 right-6 z-50 p-4 rounded-2xl shadow-2xl backdrop-blur-lg border ${notification.type === 'success' ? 'bg-green-500/90 border-green-400/50' : 'bg-red-500/90 border-red-400/50'} text-white font-medium animate-slide-in`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-lg\",\n          children: notification.type === 'success' ? '✅' : '❌'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: notification.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setNotification(null),\n          className: \"ml-2 text-white/80 hover:text-white transition-colors\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative z-10 container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 md:py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-8 sm:mb-12 md:mb-16\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inline-block p-6 bg-white/10 backdrop-blur-lg rounded-3xl border border-white/20 shadow-2xl mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black text-white mb-3 bg-gradient-to-r from-white via-purple-200 to-pink-200 bg-clip-text text-transparent\",\n            children: \"\\uD83D\\uDCF8 Strip Photobooth\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-24 h-1 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full mx-auto mb-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-base sm:text-lg md:text-xl text-white/90 font-medium\",\n            children: \"Create amazing photo strips instantly!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-md sm:max-w-lg md:max-w-xl mx-auto px-4 sm:px-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white/5 backdrop-blur-xl rounded-3xl p-6 sm:p-8 border border-white/10 shadow-2xl relative overflow-hidden\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center mb-6\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inline-flex items-center space-x-3 bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-3 border border-white/20\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-2xl\",\n                children: \"\\uD83D\\uDCF9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-xl sm:text-2xl font-bold text-white\",\n                children: \"Camera\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative group\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              ref: videoRef,\n              autoPlay: true,\n              playsInline: true,\n              className: \"w-full aspect-video rounded-2xl shadow-2xl border-4 border-white/20 group-hover:border-white/30 transition-all duration-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent rounded-2xl pointer-events-none\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this), countdown && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 flex items-center justify-center bg-black/70 backdrop-blur-sm rounded-2xl\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-4xl sm:text-6xl md:text-7xl font-black text-white animate-bounce drop-shadow-2xl mb-2\",\n                  children: countdown\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-white/80 text-sm sm:text-base font-medium\",\n                  children: \"Get ready!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex justify-center space-x-3\",\n              children: [1, 2, 3].map(step => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col items-center space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `w-4 h-4 sm:w-5 sm:h-5 rounded-full border-2 transition-all duration-500 ${steps >= step ? 'bg-gradient-to-r from-green-400 to-emerald-400 border-green-300 shadow-lg shadow-green-400/50' : 'bg-white/10 border-white/30'}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 278,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `text-xs font-medium transition-colors duration-300 ${steps >= step ? 'text-green-300' : 'text-white/50'}`,\n                  children: step\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 285,\n                  columnNumber: 21\n                }, this)]\n              }, step, true, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-8\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: startCapture,\n              disabled: steps >= 3,\n              className: `w-full py-4 sm:py-5 px-6 rounded-2xl font-bold text-lg sm:text-xl transition-all duration-300 transform relative overflow-hidden ${steps >= 3 ? 'bg-gradient-to-r from-gray-500 to-gray-600 cursor-not-allowed text-gray-200' : 'bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 hover:from-pink-600 hover:via-purple-600 hover:to-indigo-600 text-white shadow-2xl hover:shadow-pink-500/25 hover:scale-105 active:scale-95'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative z-10 flex items-center justify-center space-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-2xl\",\n                  children: steps >= 3 ? '✅' : '📸'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 307,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: steps >= 3 ? 'All Photos Captured!' : 'Capture Photo'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this), steps < 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-8 pt-6 border-t border-gradient-to-r from-transparent via-white/20 to-transparent\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"inline-block bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-3 border border-white/20\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-white/90 text-sm sm:text-base font-medium\",\n                  children: steps >= 3 ? '🎉 Ready to create your strip!' : `📷 ${3 - steps} more photo${3 - steps > 1 ? 's' : ''} needed`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 19\n                }, this), settings.eventName && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-purple-300 text-xs sm:text-sm mt-2 font-medium\",\n                  children: [\"\\uD83C\\uDF8A \", settings.eventName]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: submit,\n              disabled: steps < 3 || isSubmitting,\n              className: `w-full py-4 sm:py-5 px-6 rounded-2xl font-bold text-lg sm:text-xl transition-all duration-300 transform relative overflow-hidden ${steps >= 3 && !isSubmitting ? 'bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500 hover:from-emerald-600 hover:via-green-600 hover:to-teal-600 text-white shadow-2xl hover:shadow-emerald-500/25 hover:scale-105 active:scale-95' : 'bg-gradient-to-r from-gray-600 to-gray-700 text-gray-400 cursor-not-allowed'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative z-10 flex items-center justify-center space-x-3\",\n                children: isSubmitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 342,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Creating Strip...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 343,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-2xl\",\n                    children: \"\\uD83D\\uDE80\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Submit Strip\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 17\n              }, this), steps >= 3 && !isSubmitting && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          width: \"480\",\n          height: \"720\",\n          className: \"hidden\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 5\n  }, this);\n}\n_s(CapturePage, \"fuVzZ2md0cAMJRDcKpHBLOLlKkk=\");\n_c = CapturePage;\nvar _c;\n$RefreshReg$(_c, \"CapturePage\");","map":{"version":3,"names":["useRef","useState","useEffect","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","CapturePage","_s","videoRef","canvasRef","steps","setSteps","countdown","setCountdown","settings","setSettings","eventName","background","type","value","logo","notification","setNotification","isSubmitting","setIsSubmitting","capturedPhotos","setCapturedPhotos","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","initializeCanvas","current","_settings$background","ctx","getContext","width","height","console","log","clearRect","bgColor","fillStyle","fillRect","savedSettings","localStorage","getItem","parsedSettings","JSON","parse","navigator","mediaDevices","getUserMedia","video","then","stream","srcObject","catch","error","warn","message","startCapture","countdownInterval","setInterval","prev","clearInterval","takePhoto","_settings$background2","photoHeight","fullHeight","forEach","photoData","index","img","Image","onload","drawImage","src","tempCanvas","document","createElement","tempCtx","toDataURL","font","fillText","submit","dataUrl","post","image","timer","setTimeout","clearTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","autoPlay","playsInline","map","step","disabled","_c","$RefreshReg$"],"sources":["D:/Strip/frontend/src/components/CapturePage.js"],"sourcesContent":["import { useRef, useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport '../styles/mobile.css';\r\n\r\nexport default function CapturePage() {\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const [steps, setSteps] = useState(0);\r\n  const [countdown, setCountdown] = useState(null);\r\n  const [settings, setSettings] = useState({\r\n    eventName: '',\r\n    background: { type: 'color', value: '#ff0000' },\r\n    logo: null\r\n  });\r\n  const [notification, setNotification] = useState(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [capturedPhotos, setCapturedPhotos] = useState([]); // Store captured photo data\r\n\r\n  // Fallback API URL if environment variable is not set\r\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5000';\r\n\r\n\r\n\r\n  // Initialize canvas with background\r\n  const initializeCanvas = () => {\r\n    if (canvasRef.current) {\r\n      const ctx = canvasRef.current.getContext(\"2d\");\r\n      const width = 480;\r\n      const height = 720;\r\n\r\n      console.log('Initializing canvas...');\r\n\r\n      // Clear canvas\r\n      ctx.clearRect(0, 0, width, height);\r\n\r\n      // Apply background color\r\n      const bgColor = settings.background?.value || '#ff0000';\r\n      ctx.fillStyle = bgColor;\r\n      ctx.fillRect(0, 0, width, height);\r\n\r\n      console.log('Canvas initialized with background:', bgColor);\r\n    }\r\n  };\r\n\r\n  // Load settings from localStorage\r\n  useEffect(() => {\r\n    const savedSettings = localStorage.getItem('photoBoothSettings');\r\n    console.log('Loading settings from localStorage:', savedSettings);\r\n    if (savedSettings) {\r\n      const parsedSettings = JSON.parse(savedSettings);\r\n      console.log('Parsed settings:', parsedSettings);\r\n      setSettings(parsedSettings);\r\n    }\r\n  }, []);\r\n\r\n  // Initialize canvas when settings change\r\n  useEffect(() => {\r\n    if (canvasRef.current && settings.background.value) {\r\n      initializeCanvas();\r\n    }\r\n  }, [settings.background.value]);\r\n\r\n  useEffect(() => {\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: true })\r\n      .then((stream) => {\r\n        if (videoRef.current) videoRef.current.srcObject = stream;\r\n      })\r\n      .catch((error) => {\r\n        console.warn(\"Camera access denied:\", error);\r\n        setNotification({\r\n          type: \"error\",\r\n          message: \"Camera access required. Please allow webcam access and refresh the page.\"\r\n        });\r\n      });\r\n  }, []);\r\n\r\n  const startCapture = () => {\r\n    if (steps >= 3) return;\r\n    setCountdown(3);\r\n    const countdownInterval = setInterval(() => {\r\n      setCountdown((prev) => {\r\n        if (prev <= 1) {\r\n          clearInterval(countdownInterval);\r\n          takePhoto();\r\n          return null;\r\n        }\r\n        return prev - 1;\r\n      });\r\n    }, 1000);\r\n  };\r\n\r\n  const takePhoto = () => {\r\n    const ctx = canvasRef.current.getContext(\"2d\");\r\n    const width = 480;\r\n    const photoHeight = 240;\r\n    const fullHeight = 720;\r\n\r\n    console.log('Taking photo, step:', steps);\r\n\r\n    // First, ensure canvas has background\r\n    const bgColor = settings.background?.value || '#ff0000';\r\n    console.log('Applying background color:', bgColor);\r\n\r\n    // Clear entire canvas and apply background\r\n    ctx.clearRect(0, 0, width, fullHeight);\r\n    ctx.fillStyle = bgColor;\r\n    ctx.fillRect(0, 0, width, fullHeight);\r\n\r\n    // Redraw all previously captured photos\r\n    capturedPhotos.forEach((photoData, index) => {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        ctx.drawImage(img, 0, index * photoHeight, width, photoHeight);\r\n      };\r\n      img.src = photoData;\r\n    });\r\n\r\n    // Capture current photo from video\r\n    const tempCanvas = document.createElement('canvas');\r\n    tempCanvas.width = width;\r\n    tempCanvas.height = photoHeight;\r\n    const tempCtx = tempCanvas.getContext('2d');\r\n    tempCtx.drawImage(videoRef.current, 0, 0, width, photoHeight);\r\n\r\n    // Store the captured photo data\r\n    const photoData = tempCanvas.toDataURL();\r\n    setCapturedPhotos(prev => [...prev, photoData]);\r\n\r\n    // Draw current photo on main canvas\r\n    console.log('Drawing current photo at position:', 0, steps * photoHeight, width, photoHeight);\r\n    ctx.drawImage(videoRef.current, 0, steps * photoHeight, width, photoHeight);\r\n\r\n    // Optional logo overlay\r\n    if (settings.logo) {\r\n      const img = new Image();\r\n      img.src = settings.logo; // settings.logo is already a base64 string\r\n      img.onload = () => {\r\n        ctx.drawImage(img, 10, 10, 100, 50);\r\n      };\r\n    }\r\n\r\n    // Optional event name text on last step\r\n    if (steps === 2 && settings.eventName) {\r\n      ctx.fillStyle = \"#ffffff\";\r\n      ctx.font = \"24px sans-serif\";\r\n      ctx.fillText(settings.eventName, 10, 710);\r\n    }\r\n\r\n    setSteps(steps + 1);\r\n  };\r\n\r\n  const submit = async () => {\r\n    if (isSubmitting) return;\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      setNotification(null);\r\n\r\n      const dataUrl = canvasRef.current.toDataURL(\"image/jpeg\", 0.8);\r\n\r\n      await axios.post(`${API_BASE_URL}/api/strips`, {\r\n        image: dataUrl,\r\n        eventName: settings.eventName,\r\n        background: settings.background,\r\n        logo: settings.logo,\r\n      });\r\n\r\n      setNotification({\r\n        type: \"success\",\r\n        message: \"✅ Thank you! Your photo strip has been sent for print.\"\r\n      });\r\n\r\n      setSteps(0);\r\n      setCapturedPhotos([]); // Clear captured photos\r\n      initializeCanvas(); // Clear and reinitialize with background\r\n    } catch (error) {\r\n      console.warn(\"Upload failed:\", error);\r\n      setNotification({\r\n        type: \"error\",\r\n        message: \"❌ Failed to upload. Please check your connection and try again.\"\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Auto-hide notification after 5 seconds\r\n  useEffect(() => {\r\n    if (notification) {\r\n      const timer = setTimeout(() => {\r\n        setNotification(null);\r\n      }, 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [notification]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 relative overflow-hidden\">\r\n      {/* Animated Background Elements */}\r\n      <div className=\"absolute inset-0 overflow-hidden\">\r\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse\"></div>\r\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000\"></div>\r\n        <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-pink-500/10 rounded-full blur-3xl animate-pulse delay-500\"></div>\r\n      </div>\r\n\r\n      {/* Notification */}\r\n      {notification && (\r\n        <div className={`fixed top-6 right-6 z-50 p-4 rounded-2xl shadow-2xl backdrop-blur-lg border ${\r\n          notification.type === 'success'\r\n            ? 'bg-green-500/90 border-green-400/50'\r\n            : 'bg-red-500/90 border-red-400/50'\r\n        } text-white font-medium animate-slide-in`}>\r\n          <div className=\"flex items-center space-x-3\">\r\n            <span className=\"text-lg\">{notification.type === 'success' ? '✅' : '❌'}</span>\r\n            <span>{notification.message}</span>\r\n            <button\r\n              onClick={() => setNotification(null)}\r\n              className=\"ml-2 text-white/80 hover:text-white transition-colors\"\r\n            >\r\n              ✕\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"relative z-10 container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 md:py-12\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8 sm:mb-12 md:mb-16\">\r\n          <div className=\"inline-block p-6 bg-white/10 backdrop-blur-lg rounded-3xl border border-white/20 shadow-2xl mb-6\">\r\n            <h1 className=\"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black text-white mb-3 bg-gradient-to-r from-white via-purple-200 to-pink-200 bg-clip-text text-transparent\">\r\n              📸 Strip Photobooth\r\n            </h1>\r\n            <div className=\"w-24 h-1 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full mx-auto mb-4\"></div>\r\n            <p className=\"text-base sm:text-lg md:text-xl text-white/90 font-medium\">Create amazing photo strips instantly!</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Enhanced Camera Section */}\r\n        <div className=\"max-w-md sm:max-w-lg md:max-w-xl mx-auto px-4 sm:px-0\">\r\n          <div className=\"bg-white/5 backdrop-blur-xl rounded-3xl p-6 sm:p-8 border border-white/10 shadow-2xl relative overflow-hidden\">\r\n            {/* Decorative elements */}\r\n            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400\"></div>\r\n\r\n            <div className=\"text-center mb-6\">\r\n              <div className=\"inline-flex items-center space-x-3 bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-3 border border-white/20\">\r\n                <span className=\"text-2xl\">📹</span>\r\n                <h3 className=\"text-xl sm:text-2xl font-bold text-white\">Camera</h3>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"relative group\">\r\n              <video\r\n                ref={videoRef}\r\n                autoPlay\r\n                playsInline\r\n                className=\"w-full aspect-video rounded-2xl shadow-2xl border-4 border-white/20 group-hover:border-white/30 transition-all duration-300\"\r\n              />\r\n\r\n              {/* Overlay gradient */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent rounded-2xl pointer-events-none\"></div>\r\n\r\n              {countdown && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center bg-black/70 backdrop-blur-sm rounded-2xl\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-4xl sm:text-6xl md:text-7xl font-black text-white animate-bounce drop-shadow-2xl mb-2\">\r\n                      {countdown}\r\n                    </div>\r\n                    <div className=\"text-white/80 text-sm sm:text-base font-medium\">Get ready!</div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Enhanced Progress indicator */}\r\n              <div className=\"mt-6 flex justify-center space-x-3\">\r\n                {[1, 2, 3].map((step) => (\r\n                  <div key={step} className=\"flex flex-col items-center space-y-2\">\r\n                    <div\r\n                      className={`w-4 h-4 sm:w-5 sm:h-5 rounded-full border-2 transition-all duration-500 ${\r\n                        steps >= step\r\n                          ? 'bg-gradient-to-r from-green-400 to-emerald-400 border-green-300 shadow-lg shadow-green-400/50'\r\n                          : 'bg-white/10 border-white/30'\r\n                      }`}\r\n                    />\r\n                    <span className={`text-xs font-medium transition-colors duration-300 ${\r\n                      steps >= step ? 'text-green-300' : 'text-white/50'\r\n                    }`}>\r\n                      {step}\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Enhanced Capture Button */}\r\n            <div className=\"mt-8\">\r\n              <button\r\n                onClick={startCapture}\r\n                disabled={steps >= 3}\r\n                className={`w-full py-4 sm:py-5 px-6 rounded-2xl font-bold text-lg sm:text-xl transition-all duration-300 transform relative overflow-hidden ${\r\n                  steps >= 3\r\n                    ? 'bg-gradient-to-r from-gray-500 to-gray-600 cursor-not-allowed text-gray-200'\r\n                    : 'bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 hover:from-pink-600 hover:via-purple-600 hover:to-indigo-600 text-white shadow-2xl hover:shadow-pink-500/25 hover:scale-105 active:scale-95'\r\n                }`}\r\n              >\r\n                <div className=\"relative z-10 flex items-center justify-center space-x-3\">\r\n                  <span className=\"text-2xl\">{steps >= 3 ? '✅' : '📸'}</span>\r\n                  <span>{steps >= 3 ? 'All Photos Captured!' : 'Capture Photo'}</span>\r\n                </div>\r\n                {steps < 3 && (\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"></div>\r\n                )}\r\n              </button>\r\n            </div>\r\n\r\n            {/* Enhanced Submit Section */}\r\n            <div className=\"mt-8 pt-6 border-t border-gradient-to-r from-transparent via-white/20 to-transparent\">\r\n              <div className=\"text-center mb-6\">\r\n                <div className=\"inline-block bg-white/10 backdrop-blur-lg rounded-2xl px-6 py-3 border border-white/20\">\r\n                  <p className=\"text-white/90 text-sm sm:text-base font-medium\">\r\n                    {steps >= 3 ? '🎉 Ready to create your strip!' : `📷 ${3 - steps} more photo${3 - steps > 1 ? 's' : ''} needed`}\r\n                  </p>\r\n                  {settings.eventName && (\r\n                    <p className=\"text-purple-300 text-xs sm:text-sm mt-2 font-medium\">🎊 {settings.eventName}</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Enhanced Submit Button */}\r\n              <button\r\n                onClick={submit}\r\n                disabled={steps < 3 || isSubmitting}\r\n                className={`w-full py-4 sm:py-5 px-6 rounded-2xl font-bold text-lg sm:text-xl transition-all duration-300 transform relative overflow-hidden ${\r\n                  steps >= 3 && !isSubmitting\r\n                    ? 'bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500 hover:from-emerald-600 hover:via-green-600 hover:to-teal-600 text-white shadow-2xl hover:shadow-emerald-500/25 hover:scale-105 active:scale-95'\r\n                    : 'bg-gradient-to-r from-gray-600 to-gray-700 text-gray-400 cursor-not-allowed'\r\n                }`}\r\n              >\r\n                <div className=\"relative z-10 flex items-center justify-center space-x-3\">\r\n                  {isSubmitting ? (\r\n                    <>\r\n                      <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\r\n                      <span>Creating Strip...</span>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <span className=\"text-2xl\">🚀</span>\r\n                      <span>Submit Strip</span>\r\n                    </>\r\n                  )}\r\n                </div>\r\n                {steps >= 3 && !isSubmitting && (\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"></div>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Preview Canvas (hidden) */}\r\n          <canvas\r\n            ref={canvasRef}\r\n            width=\"480\"\r\n            height=\"720\"\r\n            className=\"hidden\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}