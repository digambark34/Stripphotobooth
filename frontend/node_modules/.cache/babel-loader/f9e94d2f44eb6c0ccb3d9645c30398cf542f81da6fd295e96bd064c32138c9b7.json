{"ast":null,"code":"var _jsxFileName = \"D:\\\\Strip\\\\frontend\\\\src\\\\components\\\\CapturePage.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CapturePage() {\n  _s();\n  const videoRef = useRef(),\n    canvasRef = useRef();\n  const [steps, setSteps] = useState(0);\n  const [countdown, setCountdown] = useState(null);\n  const [background, setBackground] = useState({\n    type: \"color\",\n    value: \"#ff0000\"\n  });\n  const [eventName, setEventName] = useState(\"\");\n  const [logo, setLogo] = useState(null);\n  useEffect(() => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(s => videoRef.current.srcObject = s).catch(() => alert(\"Camera is not available.\"));\n  }, []);\n  const startCapture = () => {\n    if (steps >= 3) return;\n    setCountdown(3);\n    const i = setInterval(() => {\n      setCountdown(c => {\n        if (c <= 1) {\n          clearInterval(i);\n          takePhoto();\n          return null;\n        }\n        return c - 1;\n      });\n    }, 1000);\n  };\n  const takePhoto = () => {\n    const ctx = canvasRef.current.getContext(\"2d\");\n    const w = 480,\n      h = 240;\n    if (steps === 0) {\n      if (background.type === \"color\") {\n        ctx.fillStyle = background.value;\n        ctx.fillRect(0, 0, w, 720);\n      }\n    }\n    ctx.drawImage(videoRef.current, 0, steps * h, w, h);\n    if (logo) {\n      const img = new Image();\n      img.src = URL.createObjectURL(logo);\n      img.onload = () => {\n        ctx.drawImage(img, 10, 10, 100, 50);\n      };\n    }\n    if (steps === 2) {\n      ctx.fillStyle = \"#fff\";\n      ctx.font = \"24px sans-serif\";\n      ctx.fillText(eventName, 10, 710);\n    }\n    setSteps(steps + 1);\n  };\n  const submit = async () => {\n    const dataUrl = canvasRef.current.toDataURL(\"image/jpeg\", 0.8);\n    await axios.post(\"http://localhost:5000/api/strips\", {\n      image: dataUrl,\n      eventName,\n      background,\n      logo: logo ? URL.createObjectURL(logo) : \"\"\n    });\n    alert(\"âœ… Thank you! Your photo is sent for print.\");\n    setSteps(0);\n    canvasRef.current.getContext(\"2d\").clearRect(0, 0, 480, 720);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl mb-4\",\n      children: \"\\uD83D\\uDCF8 Strip Photobooth\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      className: \"w-full max-w-sm\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), countdown && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-4xl font-bold\",\n      children: countdown\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Event name\",\n        value: eventName,\n        onChange: e => setEventName(e.target.value),\n        className: \"border p-1 mr-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"color\",\n        value: background.value,\n        onChange: e => setBackground({\n          type: \"color\",\n          value: e.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: e => setLogo(e.target.files[0])\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: startCapture,\n      disabled: steps >= 3,\n      className: \"mt-4 bg-blue-500 text-white px-4 py-2\",\n      children: [\"Capture Photo \", steps < 3 ? steps + 1 : \"\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), steps === 3 && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: submit,\n      className: \"mt-4 bg-green-600 text-white px-4 py-2\",\n      children: \"Submit Strip\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: \"480\",\n      height: \"720\",\n      className: \"hidden\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(CapturePage, \"aLJzNsWnEDwm8zhudnxDZhXEZkQ=\");\n_c = CapturePage;\nvar _c;\n$RefreshReg$(_c, \"CapturePage\");","map":{"version":3,"names":["React","useRef","useState","useEffect","axios","jsxDEV","_jsxDEV","CapturePage","_s","videoRef","canvasRef","steps","setSteps","countdown","setCountdown","background","setBackground","type","value","eventName","setEventName","logo","setLogo","navigator","mediaDevices","getUserMedia","video","then","s","current","srcObject","catch","alert","startCapture","i","setInterval","c","clearInterval","takePhoto","ctx","getContext","w","h","fillStyle","fillRect","drawImage","img","Image","src","URL","createObjectURL","onload","font","fillText","submit","dataUrl","toDataURL","post","image","clearRect","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","placeholder","onChange","e","target","accept","files","onClick","disabled","width","height","_c","$RefreshReg$"],"sources":["D:/Strip/frontend/src/components/CapturePage.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function CapturePage() {\r\n  const videoRef = useRef(), canvasRef = useRef();\r\n  const [steps, setSteps] = useState(0);\r\n  const [countdown, setCountdown] = useState(null);\r\n  const [background, setBackground] = useState({ type: \"color\", value: \"#ff0000\" });\r\n  const [eventName, setEventName] = useState(\"\");\r\n  const [logo, setLogo] = useState(null);\r\n\r\n  useEffect(()=>{\r\n    navigator.mediaDevices.getUserMedia({ video: true })\r\n      .then(s => videoRef.current.srcObject = s)\r\n      .catch(() => alert(\"Camera is not available.\"));\r\n  },[]);\r\n\r\n  const startCapture = () => {\r\n    if (steps >=3) return;\r\n    setCountdown(3);\r\n    const i = setInterval(()=>{\r\n      setCountdown(c => {\r\n        if (c<=1) { clearInterval(i); takePhoto(); return null; }\r\n        return c-1;\r\n      });\r\n    },1000);\r\n  };\r\n\r\n  const takePhoto = () => {\r\n    const ctx = canvasRef.current.getContext(\"2d\");\r\n    const w=480, h=240;\r\n    if (steps===0){\r\n      if(background.type===\"color\"){\r\n        ctx.fillStyle = background.value;\r\n        ctx.fillRect(0,0,w,720);\r\n      }\r\n    }\r\n    ctx.drawImage(videoRef.current, 0, steps*h, w, h);\r\n    if (logo){\r\n      const img = new Image();\r\n      img.src = URL.createObjectURL(logo);\r\n      img.onload = ()=>{ ctx.drawImage(img,10,10,100,50); }\r\n    }\r\n    if (steps===2){\r\n      ctx.fillStyle=\"#fff\";\r\n      ctx.font=\"24px sans-serif\";\r\n      ctx.fillText(eventName,10,710);\r\n    }\r\n    setSteps(steps+1);\r\n  };\r\n\r\n  const submit = async ()=>{\r\n    const dataUrl = canvasRef.current.toDataURL(\"image/jpeg\",0.8);\r\n    await axios.post(\"http://localhost:5000/api/strips\", {\r\n      image: dataUrl, eventName, background, logo: logo ? URL.createObjectURL(logo):\"\",\r\n    });\r\n    alert(\"âœ… Thank you! Your photo is sent for print.\");\r\n    setSteps(0); canvasRef.current.getContext(\"2d\").clearRect(0,0,480,720);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <h2 className=\"text-xl mb-4\">ðŸ“¸ Strip Photobooth</h2>\r\n      <video ref={videoRef} autoPlay className=\"w-full max-w-sm\"/>\r\n      {countdown && <div className=\"text-4xl font-bold\">{countdown}</div>}\r\n      <div className=\"mt-2\">\r\n        <input placeholder=\"Event name\" value={eventName} onChange={e=>setEventName(e.target.value)}\r\n           className=\"border p-1 mr-2\"/>\r\n        <input type=\"color\" value={background.value} onChange={e=>setBackground({type:\"color\",value:e.target.value})}/>\r\n        <input type=\"file\" accept=\"image/*\" onChange={e=>setLogo(e.target.files[0])}/>\r\n      </div>\r\n      <button onClick={startCapture} disabled={steps>=3} className=\"mt-4 bg-blue-500 text-white px-4 py-2\">\r\n        Capture Photo {steps<3? (steps+1):\"\"}\r\n      </button>\r\n      {steps===3 && (\r\n        <button onClick={submit} className=\"mt-4 bg-green-600 text-white px-4 py-2\">\r\n          Submit Strip\r\n        </button>\r\n      )}\r\n      <canvas ref={canvasRef} width=\"480\" height=\"720\" className=\"hidden\"/>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}